import{_ as s,c as a,o as n,a as l}from"./app.7b23ef89.js";const A=JSON.parse('{"title":"Bash实践","description":"","frontmatter":{"layout":"doc"},"headers":[{"level":2,"title":"通过文件路径提取文件名称/所在目录","slug":"通过文件路径提取文件名称-所在目录","link":"#通过文件路径提取文件名称-所在目录","children":[{"level":3,"title":"使用dirname获取文件所在目录","slug":"使用dirname获取文件所在目录","link":"#使用dirname获取文件所在目录","children":[]},{"level":3,"title":"使用basename获取文件名称","slug":"使用basename获取文件名称","link":"#使用basename获取文件名称","children":[]},{"level":3,"title":"使用${str##*x}截取字符串","slug":"使用-str-x-截取字符串","link":"#使用-str-x-截取字符串","children":[]},{"level":3,"title":"使用${str%.*}截取字符串","slug":"使用-str-截取字符串","link":"#使用-str-截取字符串","children":[]},{"level":3,"title":"如果不知道该文件的后缀，但是想获取该文件的名称","slug":"如果不知道该文件的后缀-但是想获取该文件的名称","link":"#如果不知道该文件的后缀-但是想获取该文件的名称","children":[]}]},{"level":2,"title":"判断变量是否包含某个字符串","slug":"判断变量是否包含某个字符串","link":"#判断变量是否包含某个字符串","children":[{"level":3,"title":"使用grep","slug":"使用grep","link":"#使用grep","children":[]},{"level":3,"title":"使用字符串运算符","slug":"使用字符串运算符","link":"#使用字符串运算符","children":[]}]},{"level":2,"title":"xargs","slug":"xargs","link":"#xargs","children":[]},{"level":2,"title":"找出一个文件夹下所有非webp格式的图片，并转换成webp","slug":"找出一个文件夹下所有非webp格式的图片-并转换成webp","link":"#找出一个文件夹下所有非webp格式的图片-并转换成webp","children":[]},{"level":2,"title":"图片压缩","slug":"图片压缩","link":"#图片压缩","children":[]},{"level":2,"title":"检测某个目录是否是git仓库","slug":"检测某个目录是否是git仓库","link":"#检测某个目录是否是git仓库","children":[]},{"level":2,"title":"获取命令行参数","slug":"获取命令行参数","link":"#获取命令行参数","children":[{"level":3,"title":"使用getopts方法","slug":"使用getopts方法","link":"#使用getopts方法","children":[]}]},{"level":2,"title":"获取当前时间","slug":"获取当前时间","link":"#获取当前时间","children":[]},{"level":2,"title":"使用read和用户交互","slug":"使用read和用户交互","link":"#使用read和用户交互","children":[]},{"level":2,"title":"重定向输入和输出","slug":"重定向输入和输出","link":"#重定向输入和输出","children":[]}],"relativePath":"hand-notes/bash/practice-method.md"}'),p={name:"hand-notes/bash/practice-method.md"},o=l(`<h1 id="bash实践" tabindex="-1">Bash实践 <a class="header-anchor" href="#bash实践" aria-hidden="true">#</a></h1><h2 id="通过文件路径提取文件名称-所在目录" tabindex="-1">通过文件路径提取文件名称/所在目录 <a class="header-anchor" href="#通过文件路径提取文件名称-所在目录" aria-hidden="true">#</a></h2><h3 id="使用dirname获取文件所在目录" tabindex="-1">使用<code>dirname</code>获取文件所在目录 <a class="header-anchor" href="#使用dirname获取文件所在目录" aria-hidden="true">#</a></h3><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>该方法不仅可以提取文件所在的目录，还能提取目录所在的目录</p></div><p>使用方法：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">dirname</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">NAME</span></span>
<span class="line"></span></code></pre></div><p>示例：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/a1/b1/c1/foo.png</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 /a1/b1/c1</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">dirname</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$str</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">str1</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/a1/b1/c1</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 /a1/b1</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">dirname</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$str1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="使用basename获取文件名称" tabindex="-1">使用<code>basename</code>获取文件名称 <a class="header-anchor" href="#使用basename获取文件名称" aria-hidden="true">#</a></h3><p>使用方法：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">basename</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">NAME</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">SUFFIX</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><p>示例：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/a1/b1/c1/foo.png</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 foo</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">basename</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$str</span><span style="color:#C3E88D;"> .png</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 foo.png</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">basename</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$str</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="使用-str-x-截取字符串" tabindex="-1">使用<code>\${str##*x}</code>截取字符串 <a class="header-anchor" href="#使用-str-x-截取字符串" aria-hidden="true">#</a></h3><ul><li><code>x</code>是字符串中的任意字符</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>\${str##*.}</code>是<code>Bash shell</code>脚本中的参数替换（Parameter Substitution）语法，表示从字符串<code>$str</code>中删除最后一个<code>.</code>及其前面的所有内容，即删除<code>$str</code>中的文件名部分，只留下扩展名。例如，如果<code>$str</code>的值是<code>image.jpg</code>，<code>\${str##*.}</code>的结果将是<code>jpg</code>。</p><p>这个语法中，<code>##</code>符号表示从<code>字符串开头</code>删除匹配的最长内容，<code>*.</code>表示<code>任意字符（*）</code>后面跟着一个<code>.</code>。</p></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./a/dsa/fwe/s.pkg</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 s.pkg</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">##*/}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 pkg</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">##*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="使用-str-截取字符串" tabindex="-1">使用<code>\${str%.*}</code>截取字符串 <a class="header-anchor" href="#使用-str-截取字符串" aria-hidden="true">#</a></h3><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>\${str%.*}</code>是一个<code>Bash shell</code>脚本中的参数替换（Parameter Substitution）语法，表示删除字符串<code>$str</code>中<code>最后一个.</code>及其后面的所有内容，即删除<code>$str</code>文件名中的文件扩展名。例如，如果<code>$str</code>的值是<code>image.jpg</code>，<code>\${str%.*}</code>的结果将是<code>image</code>。</p><p>这个语法中，<code>%</code>符号表示<code>从字符串末尾</code>删除匹配的最短内容，<code>.*</code>表示<code>字符（.）</code>后面跟着<code>零个或多个字符</code>。</p></div><h3 id="如果不知道该文件的后缀-但是想获取该文件的名称" tabindex="-1">如果不知道该文件的后缀，但是想获取该文件的名称 <a class="header-anchor" href="#如果不知道该文件的后缀-但是想获取该文件的名称" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./a/dsa/fwe/s.pkg</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">basename</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">str</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> .</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">str</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">})</span></span>
<span class="line"></span></code></pre></div><h2 id="判断变量是否包含某个字符串" tabindex="-1">判断变量是否包含某个字符串 <a class="header-anchor" href="#判断变量是否包含某个字符串" aria-hidden="true">#</a></h2><h3 id="使用grep" tabindex="-1">使用<code>grep</code> <a class="header-anchor" href="#使用grep" aria-hidden="true">#</a></h3><p>示例：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/a1/b1/c1/foo.png</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#82AAFF;">echo</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$str</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">grep</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#A6ACCD;">$res</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">包含foo</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">不包含foo</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"></span></code></pre></div><h3 id="使用字符串运算符" tabindex="-1">使用<code>字符串运算符</code> <a class="header-anchor" href="#使用字符串运算符" aria-hidden="true">#</a></h3><ul><li>利用字符串运算符<code>=~</code>直接判断<code>str</code>中是否包含<code>foo</code></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/a1/b1/c1/foo.png</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#A6ACCD;">$res</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=~</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">包含foo</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">不包含foo</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"></span></code></pre></div><h2 id="xargs" tabindex="-1"><code>xargs</code> <a class="header-anchor" href="#xargs" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>xargs</code>命令是将<code>前一个命令的输出结果</code>作为<code>参数</code>传递给后一个命令。</p></div><p>例如：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 在这个例子中，find命令的输出结果（即&quot;.jpg&quot;文件列表）会被传递给xargs命令。</span></span>
<span class="line"><span style="color:#FFCB6B;">find</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-name</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">xargs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span></span>
<span class="line"></span></code></pre></div><h2 id="找出一个文件夹下所有非webp格式的图片-并转换成webp" tabindex="-1">找出一个文件夹下所有非<code>webp</code>格式的图片，并转换成<code>webp</code> <a class="header-anchor" href="#找出一个文件夹下所有非webp格式的图片-并转换成webp" aria-hidden="true">#</a></h2><ul><li>解决文件名称带空格问题<a href="https://www.cyberciti.biz/tips/handling-filenames-with-spaces-in-bash.html" target="_blank" rel="noreferrer">参考链接</a></li><li><code>cwebp</code><a href="https://developers.google.com/speed/webp/docs/cwebp?hl=zh-cn" target="_blank" rel="noreferrer">文档链接</a></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#! /bin/bash</span></span>
<span class="line"><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-e</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#82AAFF;">read</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">是否删除原文件(y/n，默认n不删除): </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">isDeleteOriginalFile</span></span>
<span class="line"><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">$1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">  dir</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;font-style:italic;">$1</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 如果传的是个非webp图片就直接压缩</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">];</span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">  EXT</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#82AAFF;">echo</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">}&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">tr</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[:upper:]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[:lower:]</span><span style="color:#89DDFF;">&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">EXT</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=~</span><span style="color:#A6ACCD;"> ^(jpg</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">png</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">jpeg)$ </span><span style="color:#89DDFF;">]];</span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">    FILENAME</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">basename</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">}&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    DIRNAME</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">dirname</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">转换图片【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">cwebp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-quiet</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">DIRNAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">FILENAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.webp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">该文件不用转换/不能被转换</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">all_files</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">find</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$dir</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">egrep</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\\.(jpg|JPG|png|PNG|jpeg|JPEG)</span><span style="color:#89DDFF;">&#39;)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#all_files=$(find \${dir} -type f \\( -iname &quot;*.jpg&quot; -o -iname &quot;*.jpeg&quot; -o -iname &quot;*.png&quot; \\) );</span></span>
<span class="line"><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">SAVEIFS</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">$IFS</span></span>
<span class="line"><span style="color:#A6ACCD;">IFS</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#82AAFF;">echo</span><span style="color:#C3E88D;"> -en </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\\n\\b</span><span style="color:#89DDFF;">&quot;)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> FILE </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">all_files</span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  FILENAME</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">basename</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">FILE</span><span style="color:#89DDFF;">}&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">FILE</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  DIRNAME</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">dirname</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">FILE</span><span style="color:#89DDFF;">}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  EXT</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">FILE</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">EXT</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=~</span><span style="color:#A6ACCD;"> ^(webp</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">WEBP)$ </span><span style="color:#89DDFF;">]];</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">++))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">转换第【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">i</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】个图片【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">FILE</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">cwebp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-quiet</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">FILE</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">DIRNAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">FILENAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.webp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isDeleteOriginalFile</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isDeleteOriginalFile</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">y</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">FILE</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#A6ACCD;">IFS</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">$SAVEIFS</span></span>
<span class="line"></span></code></pre></div><h2 id="图片压缩" tabindex="-1">图片压缩 <a class="header-anchor" href="#图片压缩" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>使用<code>shell</code>脚本，调用<a href="https://tinypng.com/" target="_blank" rel="noreferrer">tinypng</a>API来进行图片压缩</p></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-e</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">compress_fn()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">local</span><span style="color:#A6ACCD;"> file</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;font-style:italic;">$1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">local</span><span style="color:#A6ACCD;"> isDelOriginalFile</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;font-style:italic;">$2</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">local</span><span style="color:#A6ACCD;"> FILENAME</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">basename</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">}&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">local</span><span style="color:#A6ACCD;"> DIRNAME</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">dirname</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">}&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">local</span><span style="color:#A6ACCD;"> EXT</span><span style="color:#89DDFF;">=\${</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">##*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">上传【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  output</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> https://api.tinify.com/shrink --user api:</span><span style="color:#A6ACCD;">$API_KEY</span><span style="color:#C3E88D;"> --data-binary @</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> -s </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">sed</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s/&quot;//g</span><span style="color:#89DDFF;">&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  output_url</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#82AAFF;">echo</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">$output</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">sed</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s/.*url:\\(.*\\)}}.*/\\1/g</span><span style="color:#89DDFF;">&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  save_url</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">DIRNAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">FILENAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">_compress.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">EXT</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isDelOriginalFile</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isDelOriginalFile</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">y</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">]];</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">    save_url</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">DIRNAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">FILENAME</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">EXT</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">下载压缩后的图片【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">save_url</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> $output_url </span><span style="color:#C3E88D;">--user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">api:</span><span style="color:#A6ACCD;">$API_KEY </span><span style="color:#C3E88D;">--output</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">save_url</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-s</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">API_KEY</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">your_api_key</span></span>
<span class="line"><span style="color:#A6ACCD;">compress_dir</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">$1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">  compress_dir</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;font-style:italic;">$1</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#82AAFF;">read</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">是否删除原文件(y/n，默认n不删除): </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">isDeleteOriginalFile</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">compress_dir</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">];</span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">  EXT</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#82AAFF;">echo</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">compress_dir</span><span style="color:#89DDFF;">##*</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">}&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">tr</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[:upper:]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[:lower:]</span><span style="color:#89DDFF;">&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">EXT</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=~</span><span style="color:#A6ACCD;"> ^(jpg</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">png</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">jpeg</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">webp)$ </span><span style="color:#89DDFF;">]];</span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">compress_fn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">compress_dir</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isDeleteOriginalFile</span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">该文件不是图片</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">exit</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">all_files</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">find</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">compress_dir</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">egrep</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\\.(jpg|JPG|jpeg|JPEG|png|PNG|webp|WEBP)</span><span style="color:#89DDFF;">&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">SAVEIFS</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">$IFS</span></span>
<span class="line"><span style="color:#A6ACCD;">IFS</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#82AAFF;">echo</span><span style="color:#C3E88D;"> -en </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\\n\\b</span><span style="color:#89DDFF;">&quot;)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> file </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">all_files</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">compress_fn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isDeleteOriginalFile</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#A6ACCD;">IFS</span><span style="color:#89DDFF;">=\${</span><span style="color:#A6ACCD;">SAVEIFS</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#82AAFF;">wait</span></span>
<span class="line"></span></code></pre></div><h2 id="检测某个目录是否是git仓库" tabindex="-1">检测某个目录是否是git仓库 <a class="header-anchor" href="#检测某个目录是否是git仓库" aria-hidden="true">#</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">isGit</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">git</span><span style="color:#C3E88D;"> rev-parse --git-dir </span><span style="color:#89DDFF;">2&gt;</span><span style="color:#C3E88D;"> /dev/null</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">isGit</span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="获取命令行参数" tabindex="-1">获取命令行参数 <a class="header-anchor" href="#获取命令行参数" aria-hidden="true">#</a></h2><h3 id="使用getopts方法" tabindex="-1">使用<code>getopts</code>方法 <a class="header-anchor" href="#使用getopts方法" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> getopts</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">:t:p:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> opt</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#A6ACCD;"> $opt </span><span style="color:#89DDFF;font-style:italic;">in</span></span>
<span class="line"><span style="color:#A6ACCD;">    t</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">t为</span><span style="color:#A6ACCD;">$OPTARG</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">    p</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">p为</span><span style="color:#A6ACCD;">$OPTARG</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">?)</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">未知参数</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">esac</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ./test.sh -t debug -p ./app/asd</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出 参数t的值为debug 参数p的值为./app/asd</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ./test.sh -a </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输出未知参数</span></span>
<span class="line"></span></code></pre></div><h2 id="获取当前时间" tabindex="-1">获取当前时间 <a class="header-anchor" href="#获取当前时间" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>date</code> 后面有一个空格，否则无法识别命令</p></div><ul><li><code>Y</code>显示<code>4位年份</code>，例如<code>2023</code></li><li><code>y</code>显示<code>2位年份</code>，例如<code>23</code></li><li><code>M</code>表示<code>分钟</code></li><li><code>m</code>表示<code>数字月份</code></li><li><code>D</code>表示<code>当前日期</code>，例如<code>01/05/23</code>，也就是<code>23年1月5号</code></li><li><code>d</code>表示<code>天</code></li><li><code>H</code>表示<code>小时</code></li><li><code>h</code>表示<code>英文月份</code>，例如<code>Jan</code></li><li><code>S</code>表示<code>当前秒钟</code>，单位为<code>秒</code></li><li><code>s</code>表示<code>当前秒钟</code>，单位为<code>毫秒</code></li></ul><p>示例：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">time</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">date</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">+%Y-%m-%d %H:%M:%S</span><span style="color:#89DDFF;">&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">day</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">date</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">+%D</span><span style="color:#89DDFF;">&quot;)</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">time</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">day</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 打印</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 2023-01-05 16:08:29</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 01/05/23</span></span>
<span class="line"></span></code></pre></div><h2 id="使用read和用户交互" tabindex="-1">使用<code>read</code>和用户交互 <a class="header-anchor" href="#使用read和用户交互" aria-hidden="true">#</a></h2><ul><li><code>read</code>命令可以用作与用户的交互中，需要用户去输入一些信息</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">read</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">options</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">设置需要获取的变量名</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th style="text-align:center;">options</th><th style="text-align:center;">含义</th></tr></thead><tbody><tr><td style="text-align:center;">-p</td><td style="text-align:center;">提示信息，在等待<code>read</code>输入时的<code>提示信息</code></td></tr><tr><td style="text-align:center;">-t</td><td style="text-align:center;">等待用户输入的<code>秒数</code>: <code>read</code>命令会一直等待用户输入，超过这个时间自动走到下一条命令</td></tr><tr><td style="text-align:center;">-n</td><td style="text-align:center;">当用户输入的字符等于<code>n</code>指定的数字时，就自动进入下一条命令</td></tr><tr><td style="text-align:center;">-s</td><td style="text-align:center;">隐藏数据，一般在需要<code>输入密码</code>时使用</td></tr></tbody></table><h2 id="重定向输入和输出" tabindex="-1">重定向输入和输出 <a class="header-anchor" href="#重定向输入和输出" aria-hidden="true">#</a></h2><p>将输入/输出内容重定向到<code>/dev/null</code>文件中</p><p>例如：获取当前登录的<code>npm</code>用户，如果没有获取到，就登录</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">loginName</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">npm</span><span style="color:#C3E88D;"> whoami </span><span style="color:#89DDFF;">2&gt;</span><span style="color:#C3E88D;">/dev/null</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">loginName</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">请先登录</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">login</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"></span></code></pre></div><ul><li>如果当前命令行未登录<code>npm</code>账号，会报如下错误，如果已登录，则会返回当前登录的<code>npm账号名称</code></li><li>我们在上面将<code>错误输出</code>重定向到了<code>/dev/null</code>文件中，这样如果未登录就避免报错，而是得到了空字符串</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ERR!</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">code</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ENEEDAUTH</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ERR!</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">need</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">auth</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">This</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">command</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">requires</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">you</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">be</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logged</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">in.</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ERR!</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">need</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">auth</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">You</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">need</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">authorize</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">this</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">machine</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">using</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">npm</span><span style="color:#C3E88D;"> adduser</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ERR!</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">A</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">complete</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">log</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">this</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">can</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">be</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">in:</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ERR!</span><span style="color:#A6ACCD;">     </span><span style="color:#C3E88D;">/Users/xxx/.npm/_logs/</span><span style="color:#F78C6C;">2023</span><span style="color:#C3E88D;">-</span><span style="color:#F78C6C;">03</span><span style="color:#C3E88D;">-10T15_19_28_286Z-debug-0.log</span></span>
<span class="line"></span></code></pre></div>`,58),e=[o];function t(c,r,D,y,F,C){return n(),a("div",null,e)}const d=s(p,[["render",t]]);export{A as __pageData,d as default};
