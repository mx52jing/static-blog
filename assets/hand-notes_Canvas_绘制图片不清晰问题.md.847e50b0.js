import{_ as s,c as a,o as n,e as l}from"./app.fa87702c.js";const F=JSON.parse('{"title":"绘制图片不清晰问题","description":"","frontmatter":{"layout":"doc"},"headers":[{"level":2,"title":"问题原因和解决","slug":"问题原因和解决","link":"#问题原因和解决","children":[]},{"level":2,"title":"查看效果","slug":"查看效果","link":"#查看效果","children":[]}],"relativePath":"hand-notes/Canvas/绘制图片不清晰问题.md"}'),o={name:"hand-notes/Canvas/绘制图片不清晰问题.md"},p=l(`<h1 id="绘制图片不清晰问题" tabindex="-1">绘制图片不清晰问题 <a class="header-anchor" href="#绘制图片不清晰问题" aria-hidden="true">#</a></h1><h2 id="问题原因和解决" tabindex="-1">问题原因和解决 <a class="header-anchor" href="#问题原因和解决" aria-hidden="true">#</a></h2><p><code>canvas</code>其实本质上也是一张图片，不管在<code>canvas</code>中绘制图片还是绘制其他图形，都是一样的道理</p><p>首先要明确，<code>图片/canvas</code>有以下两种尺寸</p><ul><li><strong>原始尺寸</strong></li></ul><blockquote><p>例如：这样设置</p></blockquote><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">width </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">600</span></span>
<span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">height </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">600</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 或者</span></span>
<span class="line"><span style="color:#A6ACCD;">img</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">naturalWidth</span></span>
<span class="line"><span style="color:#A6ACCD;">img</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">naturalHeight</span></span>
<span class="line"></span></code></pre></div><ul><li><strong>样式尺寸</strong></li></ul><blockquote><p>例如：在<code>css</code>中设置样式</p></blockquote><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">canvas</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">600px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">600px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>图片的清晰与否还和<code>当前页面的缩放倍率</code>有关</p><blockquote><p><code>缩放倍率</code>可以通过<code>window.devicePixelRatio</code>获取</p></blockquote><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>这三者之间有个公式如下：</p><blockquote><p><strong>原始尺寸 = 样式尺寸 * 缩放倍率</strong></p></blockquote></div><blockquote><p>比如<code>canvas</code>要呈现在页面上的大小为<code>200*200</code>，称之为<code>显示尺寸</code></p></blockquote><blockquote><p>此时我们设置<code>canvas</code>元素的<code>样式尺寸 = 200(显示尺寸)</code>，但是其实浏览器渲染的时候，会乘以<code>缩放倍率</code> 而如果我们没有设置<code>canvas</code>的原始尺寸或者设置的不符合上面的公式的时候，渲染的图片就不清晰 所以也要设置canvas的原始尺寸为<code>显示尺寸 * 缩放倍率</code> 然后将canvas进行缩放，因为如果不缩放，画出来的图形就会很小，缩放的倍数就是缩放倍率的值</p></blockquote><blockquote><p>解决方法如下：</p></blockquote><div class="tip custom-block"><p class="custom-block-title">TIP</p><ol><li>设置<code>canvas</code>的<code>样式尺寸 = 显示尺寸</code></li></ol><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">canvas</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>设置<code>canvas</code>的<code>原始尺寸 = 显示尺寸 * 像素比</code></li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> dpr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">devicePixelRatio </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">width </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> dpr</span></span>
<span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">height </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> dpr</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>经历<code>步骤2</code>后，画布大小变大了，那么画布也要进行对应的缩放，不然绘制出来的图形会很小</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ctx </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> canvas</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getContext</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">ctx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scale</span><span style="color:#A6ACCD;">(dpr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> dpr)</span></span>
<span class="line"></span></code></pre></div></div><blockquote><p>完整代码如下：假设页面上要显示的尺寸为<code>200*200</code></p></blockquote><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> displaySize </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> canvas </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#canvas-optimize</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> dpr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">devicePixelRatio </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">width </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> displaySize </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> dpr</span></span>
<span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">height </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> displaySize </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> dpr</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 或者在css中直接设置样式也可以</span></span>
<span class="line"><span style="color:#A6ACCD;">canvas</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">cssText </span><span style="color:#89DDFF;">+=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">width: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">displaySize</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px;height: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">displaySize</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ctx </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> canvas</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getContext</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2d</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">ctx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scale</span><span style="color:#A6ACCD;">(dpr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> dpr)</span></span>
<span class="line"></span></code></pre></div><h2 id="查看效果" tabindex="-1">查看效果 <a class="header-anchor" href="#查看效果" aria-hidden="true">#</a></h2><ul><li><a href="https://mx52jing.github.io/Notes/canvas-related/slove-blurry-images/index.html" target="_blank" rel="noreferrer">效果预览</a></li></ul>`,21),e=[p];function c(t,r,D,C,y,i){return n(),a("div",null,e)}const d=s(o,[["render",c]]);export{F as __pageData,d as default};
