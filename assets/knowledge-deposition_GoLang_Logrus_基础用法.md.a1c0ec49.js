import{_ as s,c as n,o as a,a as l}from"./app.98a96f68.js";const o="/static-blog/image/go/logrus_1.png",p="/static-blog/image/go/logrus_2.png",e="/static-blog/image/go/logrus_text_color.png",t="/static-blog/image/go/logrus_bg_color.png",c="/static-blog/image/go/logrus_custom_color.png",m=JSON.parse('{"title":"基础用法","description":"","frontmatter":{"layout":"doc"},"headers":[{"level":2,"title":"下载依赖","slug":"下载依赖","link":"#下载依赖","children":[]},{"level":2,"title":"输出log","slug":"输出log","link":"#输出log","children":[]},{"level":2,"title":"日志等级","slug":"日志等级","link":"#日志等级","children":[]},{"level":2,"title":"获取日志等级","slug":"获取日志等级","link":"#获取日志等级","children":[]},{"level":2,"title":"修改日志等级","slug":"修改日志等级","link":"#修改日志等级","children":[]},{"level":2,"title":"输出日志添加额外字段","slug":"输出日志添加额外字段","link":"#输出日志添加额外字段","children":[{"level":3,"title":"添加单个字段","slug":"添加单个字段","link":"#添加单个字段","children":[]},{"level":3,"title":"同时添加多个字段","slug":"同时添加多个字段","link":"#同时添加多个字段","children":[]}]},{"level":2,"title":"设置日志展示调用文件路径、行数、函数名称","slug":"设置日志展示调用文件路径、行数、函数名称","link":"#设置日志展示调用文件路径、行数、函数名称","children":[]},{"level":2,"title":"设置日志格式","slug":"设置日志格式","link":"#设置日志格式","children":[{"level":3,"title":"修改日志为json格式","slug":"修改日志为json格式","link":"#修改日志为json格式","children":[]}]},{"level":2,"title":"将日志输出到日志文件中","slug":"将日志输出到日志文件中","link":"#将日志输出到日志文件中","children":[]},{"level":2,"title":"自定义颜色","slug":"自定义颜色","link":"#自定义颜色","children":[{"level":3,"title":"文本颜色","slug":"文本颜色","link":"#文本颜色","children":[]},{"level":3,"title":"文本背景色","slug":"文本背景色","link":"#文本背景色","children":[]}]},{"level":2,"title":"实现自定义设置输入日志颜色","slug":"实现自定义设置输入日志颜色","link":"#实现自定义设置输入日志颜色","children":[]}],"relativePath":"knowledge-deposition/GoLang/Logrus/基础用法.md"}'),r={name:"knowledge-deposition/GoLang/Logrus/基础用法.md"},D=l(`<h1 id="基础用法" tabindex="-1">基础用法 <a class="header-anchor" href="#基础用法" aria-hidden="true">#</a></h1><h2 id="下载依赖" tabindex="-1">下载依赖 <a class="header-anchor" href="#下载依赖" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">go</span><span style="color:#A6ACCD;"> get github</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">sirupsen</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">logrus</span></span>
<span class="line"></span></code></pre></div><h2 id="输出log" tabindex="-1">输出<code>log</code> <a class="header-anchor" href="#输出log" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Errorln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warningln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Warn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Info</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Debugln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Debug</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="`+o+`" alt="logrus_1"></p><blockquote><p>因为日志等级默认是<code>info</code>等级，所以<code>debug</code>日志未输出</p></blockquote><h2 id="日志等级" tabindex="-1">日志等级 <a class="header-anchor" href="#日志等级" aria-hidden="true">#</a></h2><ul><li><p><code>Panic</code>：记录日志，然后<code>panic</code></p></li><li><p><code>Fatal</code>：致命错误，出现错误时程序无法正常运转，输出日志后，程序退出</p></li><li><p><code>Error</code>：错误日志，需要查看原因</p></li><li><p><code>Warn</code>：警告信息，提醒程序员注意</p></li><li><p><code>Info</code>：关键操作，核心流程的日志</p></li><li><p><code>Debug</code>：一般程序中输出的<code>调试信息</code></p></li><li><p><code>Trace</code>：很细粒度的信息，一般用不到</p></li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><ul><li><p>日志级别<code>从上向下依次增加</code>，<code>Trace</code>最大，<code>Panic</code>最小</p></li><li><p><code>logrus</code>有一个日志级别，<code>高于</code>这个级别的日志<code>不会输出</code>。默认的级别为<code>InfoLevel</code></p></li></ul></div><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">	PanicLevel Level </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">iota</span></span>
<span class="line"><span style="color:#A6ACCD;">	FatalLevel</span></span>
<span class="line"><span style="color:#A6ACCD;">	ErrorLevel</span></span>
<span class="line"><span style="color:#A6ACCD;">	WarnLevel</span></span>
<span class="line"><span style="color:#A6ACCD;">	InfoLevel</span></span>
<span class="line"><span style="color:#A6ACCD;">	DebugLevel</span></span>
<span class="line"><span style="color:#A6ACCD;">	TraceLevel</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="获取日志等级" tabindex="-1">获取日志等级 <a class="header-anchor" href="#获取日志等级" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLevel</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// info</span></span>
<span class="line"></span></code></pre></div><h2 id="修改日志等级" tabindex="-1">修改日志等级 <a class="header-anchor" href="#修改日志等级" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetLevel</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DebugLevel</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Errorln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warningln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Warn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Info</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Debugln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logrus =&gt; Debug</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLevel</span><span style="color:#89DDFF;">())</span></span>
<span class="line"></span></code></pre></div><p><img src="`+p+`" alt="logrus_2"></p><h2 id="输出日志添加额外字段" tabindex="-1">输出日志添加额外字段 <a class="header-anchor" href="#输出日志添加额外字段" aria-hidden="true">#</a></h2><h3 id="添加单个字段" tabindex="-1">添加单个字段 <a class="header-anchor" href="#添加单个字段" aria-hidden="true">#</a></h3><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetLevel</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DebugLevel</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WithField</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">如燕</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Errorln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warningln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Warn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Info</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Debugln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Debug</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">ERRO[0000] logInstance =&gt; Error                          name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">WARN[0000] logInstance =&gt; Warn                           name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">INFO[0000] logInstance =&gt; Info                           name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">DEBU[0000] logInstance =&gt; Debug                          name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span>
<span class="line"></span></code></pre></div><h3 id="同时添加多个字段" tabindex="-1">同时添加多个字段 <a class="header-anchor" href="#同时添加多个字段" aria-hidden="true">#</a></h3><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetLevel</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DebugLevel</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WithFields</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Fields</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">如燕</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">18</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Errorln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Error</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warningln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Warn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Info</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Debugln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logInstance =&gt; Debug</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">ERRO[0000] logInstance =&gt; Error                          age=18 name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">WARN[0000] logInstance =&gt; Warn                           age=18 name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">INFO[0000] logInstance =&gt; Info                           age=18 name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">DEBU[0000] logInstance =&gt; Debug                          age=18 name=&quot;如燕&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span>
<span class="line"></span></code></pre></div><h2 id="设置日志展示调用文件路径、行数、函数名称" tabindex="-1">设置日志展示调用文件路径、行数、函数名称 <a class="header-anchor" href="#设置日志展示调用文件路径、行数、函数名称" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetReportCaller</span><span style="color:#89DDFF;">(true)</span></span>
<span class="line"></span></code></pre></div><blockquote><p>实现原理如下：</p></blockquote><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">caller </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">HasCaller</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    funcVal </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Sprintf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%s()</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Caller</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Function</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    fileVal </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Sprintf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%s:%d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Caller</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">File</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Caller</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Line</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> f</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">CallerPrettyfier </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        funcVal</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileVal </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> f</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CallerPrettyfier</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Caller</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> fileVal </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        caller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> funcVal</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> funcVal </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        caller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fileVal</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        caller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fileVal </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> funcVal</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ul><li>点击<a href="https://github.com/sirupsen/logrus/blob/master/text_formatter.go#L266" target="_blank" rel="noreferrer">查看</a>具体实现</li></ul><h2 id="设置日志格式" tabindex="-1">设置日志格式 <a class="header-anchor" href="#设置日志格式" aria-hidden="true">#</a></h2><ul><li>内置两种格式<code>JSONFormatter（JSON 格式）</code>和<code>TextFormatter（文本格式）</code></li></ul><h3 id="修改日志为json格式" tabindex="-1">修改日志为<code>json</code>格式 <a class="header-anchor" href="#修改日志为json格式" aria-hidden="true">#</a></h3><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetFormatter</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">JSONFormatter</span><span style="color:#89DDFF;">{})</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 设置为json格式</span></span>
<span class="line"><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetFormatter</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">TextFormatter</span><span style="color:#89DDFF;">{})</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 设置为json格式</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WithFields</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Fields</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">如燕</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">18</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">info</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// {&quot;age&quot;:18,&quot;level&quot;:&quot;info&quot;,&quot;msg&quot;:&quot;info&quot;,&quot;name&quot;:&quot;如燕&quot;,&quot;time&quot;:&quot;2023-08-02T22:02:05+08:00&quot;}</span></span>
<span class="line"></span></code></pre></div><blockquote><p><strong><code>JSONFormatter/TextFormatter</code>中可传的一些配置如下</strong>:</p></blockquote><ul><li><p><code>ForceColors</code>：是否强制使用颜色输出</p></li><li><p><code>DisableColors</code>：是否禁用颜色输出</p></li><li><p><code>ForceQuote</code>：是否强制引用所有值</p></li><li><p><code>DisableQuote</code>：是否禁用引用所有值</p></li><li><p><code>DisableTimestamp</code>：是否禁用时间戳记录</p></li><li><p><code>FullTimestamp</code>：是否在输出完整的时间戳</p></li><li><p><code>TimestampFormat</code>：用于输出完整时间戳的时间戳格式</p></li></ul><h2 id="将日志输出到日志文件中" tabindex="-1">将日志输出到日志文件中 <a class="header-anchor" href="#将日志输出到日志文件中" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">outputFile</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	file</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> _ </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">OpenFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">logs/a.log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">O_CREATE</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">os</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">O_WRONLY</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">os</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">O_APPEND</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0666</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	writes </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">io</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Writer</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		file</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">		os</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Stdout</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 配置这个可以同时将日志输出到控制台上</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	outputWrite </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> io</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">MultiWriter</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">writes</span><span style="color:#89DDFF;">...)</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetOutput</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">outputWrite</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetFormatter</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">TextFormatter</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		FullTimestamp</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">true,</span></span>
<span class="line"><span style="color:#A6ACCD;">		TimestampFormat</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2006-01-02 15:04:05</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">	logInstance </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WithFields</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Fields</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">狄仁杰</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">70</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">	logInstance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">info</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="自定义颜色" tabindex="-1">自定义颜色 <a class="header-anchor" href="#自定义颜色" aria-hidden="true">#</a></h2><ul><li><code>Logrus</code>中对不同日志的颜色定义可点击<a href="https://github.com/sirupsen/logrus/blob/master/text_formatter.go#L232" target="_blank" rel="noreferrer">这里</a>查看</li></ul><blockquote><p>如下代码：</p></blockquote><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[30m 黑色 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><ul><li><p><code>\\033[30m</code>和<code>\\033[0m</code>是<code>ANSI转义码</code>，用于在终端输出中<code>设置文本颜色</code>，这两个转义码分别表示<code>设置文本颜色</code>为黑色和<code>重置文本颜色</code>至默认值</p></li><li><p><code>\\033(八进制表示法)</code>是<code>转义字符</code>，也可以写成<code>\\x1b(十六进制表示法)</code></p></li><li><p><code>[30m</code>表示<code>设置文本颜色</code>，<code>30</code>是<code>黑色</code>的颜色代码</p></li><li><p><code>\\033[0m</code>表示<code>重置文本颜色回到默认值</code></p></li></ul><h3 id="文本颜色" tabindex="-1">文本颜色 <a class="header-anchor" href="#文本颜色" aria-hidden="true">#</a></h3><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[30m 黑色文本 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[31m 红色文本 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[32m 绿色文本 </span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[33m 黄色文本 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[34m 蓝色文本 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[35m 紫色文本 </span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[36m 青色文本 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[37m 灰色文本 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="`+e+`" alt="logrus_text_color"></p><h3 id="文本背景色" tabindex="-1">文本背景色 <a class="header-anchor" href="#文本背景色" aria-hidden="true">#</a></h3><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[40m 黑色背景 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[41m 红色背景 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[42m 绿色背景 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[43m 黄色背景 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[44m 蓝色背景 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[45m 紫色背景 </span><span style="color:#A6ACCD;">\\033</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[46m 青色背景 </span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[47m 灰色背景 </span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[0m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="`+t+`" alt="logrus_bg_color"></p><h2 id="实现自定义设置输入日志颜色" tabindex="-1">实现自定义设置输入日志颜色 <a class="header-anchor" href="#实现自定义设置输入日志颜色" aria-hidden="true">#</a></h2><ul><li>通过实现接口<a href="https://github.com/sirupsen/logrus/blob/master/formatter.go#L26" target="_blank" rel="noreferrer">logrus.Formatter</a>可以定制自己想要的格式</li></ul><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Formatter</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">Format</span><span style="color:#89DDFF;">(*</span><span style="color:#A6ACCD;">Entry</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">([]</span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span></code></pre></div><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 设置一套颜色</span></span>
<span class="line"><span style="color:#89DDFF;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">	CRed    </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">31</span></span>
<span class="line"><span style="color:#A6ACCD;">	CYellow </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">33</span></span>
<span class="line"><span style="color:#A6ACCD;">	CCyan   </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">36</span></span>
<span class="line"><span style="color:#A6ACCD;">	CPurple </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">35</span></span>
<span class="line"><span style="color:#A6ACCD;">	CGray   </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">37</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MFormat</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">struct{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">m MFormat</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Format</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">entry </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Entry</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">([]</span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">error</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">// 设置日志颜色</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> levelColor </span><span style="color:#C792EA;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">switch</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Level </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PanicLevel</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">FatalLevel</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ErrorLevel</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">		levelColor </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CRed</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">WarnLevel</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">		levelColor </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CYellow</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">InfoLevel</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">		levelColor </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CCyan</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#A6ACCD;"> logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DebugLevel</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">		levelColor </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CPurple</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">		levelColor </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CGray</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> buffer </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">bytes</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Buffer</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Buffer</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> buffer </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		buffer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">bytes</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Buffer</span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fprintf</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[%dm[%s]</span><span style="color:#A6ACCD;">\\x1b</span><span style="color:#C3E88D;">[0m</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> levelColor</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Message</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> buffer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Bytes</span><span style="color:#89DDFF;">(),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">customLogFormat</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetLevel</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logrus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DebugLevel</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetFormatter</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">MFormat</span><span style="color:#89DDFF;">{})</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Errorln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">自定义颜色 =&gt; Error输出</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warningln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">自定义颜色 =&gt; Warn输出</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Infoln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">自定义颜色 =&gt; Info输出</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	logrus</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Debugln</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">自定义颜色 =&gt; Debug输出</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><img src="`+c+'" alt="logrus_custom_color"></p>',50),F=[D];function y(C,A,i,u,d,g){return a(),n("div",null,F)}const f=s(r,[["render",y]]);export{m as __pageData,f as default};
