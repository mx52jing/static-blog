import{_ as s,c as a,o as n,a as l}from"./app.bd1b2392.js";const i=JSON.parse('{"title":"Update","description":"","frontmatter":{"layout":"doc"},"headers":[{"level":2,"title":"保存所有字段","slug":"保存所有字段","link":"#保存所有字段","children":[]},{"level":2,"title":"更新单列","slug":"更新单列","link":"#更新单列","children":[]},{"level":2,"title":"更新多列","slug":"更新多列","link":"#更新多列","children":[]},{"level":2,"title":"更新指定字段","slug":"更新指定字段","link":"#更新指定字段","children":[]}],"relativePath":"knowledge-deposition/GoLang/Gorm/Update.md"}'),o={name:"knowledge-deposition/GoLang/Gorm/Update.md"},p=l('<h1 id="update" tabindex="-1">Update <a class="header-anchor" href="#update" aria-hidden="true">#</a></h1><h2 id="保存所有字段" tabindex="-1">保存所有字段 <a class="header-anchor" href="#保存所有字段" aria-hidden="true">#</a></h2><ul><li><p><code>Save</code>会保存所有字段，包括<code>零值</code></p></li><li><p><code>Save</code>是一个<code>组合函数</code>，如果保存的数据<code>不包含主键</code>，它将执行<code>Create</code>，否则将执行<code>Update</code>(包含所有字段)</p></li></ul><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> first Teacher</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">First</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">first</span><span style="color:#89DDFF;">)</span></span>\n<span class="line"><span style="color:#A6ACCD;">first</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">First Save</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">first</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Age </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">88</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Save</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">first</span><span style="color:#89DDFF;">)</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `name`=&#39;First Save&#39;,`age`=88,`gender`=1 WHERE `id` = 1</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> s Teacher</span></span>\n<span class="line"><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Age </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">98</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Save</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// INSERT INTO `teachers` (`name`,`age`,`gender`) VALUES (&#39;&#39;,98,0)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Save</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">ID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">11</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">魔灵</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Gender</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">})</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `name`=&#39;魔灵&#39;,`age`=20,`gender`=1 WHERE `id` = 11</span></span>\n<span class="line"></span></code></pre></div><h2 id="更新单列" tabindex="-1">更新单列 <a class="header-anchor" href="#更新单列" aria-hidden="true">#</a></h2><ul><li><p>使用<code>Update</code>更新单列时，需要<code>指定条件</code>，否则的话会返回<code>ErrMissingWhereClause</code>错误</p></li><li><p>当使用了<code>Model</code>方法，<code>且该对象主键有值</code>，该值会被用于构建条件</p></li></ul><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Model</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">Teacher</span><span style="color:#89DDFF;">{}).</span><span style="color:#82AAFF;">Where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age = ? AND gender = ?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">98</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Update</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">动灵</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `name`=&#39;动灵&#39; WHERE age = &#39;98&#39; AND gender = &#39;0&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> u Teacher</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Take</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">u</span><span style="color:#89DDFF;">)</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Model</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">u</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Update</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">剑灵</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// SELECT * FROM `teachers` LIMIT 1</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `name`=&#39;剑灵&#39; WHERE `id` = 1</span></span>\n<span class="line"></span></code></pre></div><h2 id="更新多列" tabindex="-1">更新多列 <a class="header-anchor" href="#更新多列" aria-hidden="true">#</a></h2><ul><li><p><code>Updates</code>方法支持<code>struct</code>和<code>map[string]interface{}</code>参数</p></li><li><p>当使用<code>struct</code>更新时，默认情况下，<code>GORM</code>只会更新<code>非零值</code>的字段</p></li></ul><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">ID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">}</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Model</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Updates</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">Age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">19</span><span style="color:#89DDFF;">})</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `age`=19 WHERE `id` = 2</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">ID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">}</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Model</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Updates</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">Age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">19</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">吴文登</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">})</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `name`=&#39;吴文登&#39;,`age`=19 WHERE `id` = 2</span></span>\n<span class="line"></span></code></pre></div><h2 id="更新指定字段" tabindex="-1">更新指定字段 <a class="header-anchor" href="#更新指定字段" aria-hidden="true">#</a></h2><div class="language-Go"><button title="Copy Code" class="copy"></button><span class="lang">Go</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 使用Select指定更新的字段</span></span>\n<span class="line"><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">ID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">}</span></span>\n<span class="line"><span style="color:#A6ACCD;">DB</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Model</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Select</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gender</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Updates</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Teacher</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">Age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">19</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">吴文登</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Gender</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">})</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// UPDATE `teachers` SET `age`=19,`gender`=1 WHERE `id` = 2</span></span>\n<span class="line"></span></code></pre></div>',12),e=[p];function t(c,r,D,F,y,A){return n(),a("div",null,e)}const d=s(o,[["render",t]]);export{i as __pageData,d as default};
