import{_ as s,c as n,o as a,e as o}from"./app.209d2213.js";const l="/static-blog/image/Linux/version.png",_=JSON.parse('{"title":"计算升级版本号","description":"","frontmatter":{"layout":"doc"},"headers":[],"relativePath":"hand-notes/Linux/计算升级版本号.md"}'),p={name:"hand-notes/Linux/计算升级版本号.md"},e=o('<h1 id="计算升级版本号" tabindex="-1">计算升级版本号 <a class="header-anchor" href="#计算升级版本号" aria-hidden="true">#</a></h1><ul><li>根据<code>当前的版本号</code>计算<code>升级版本后的号</code>，支持<code>自定义版本号</code></li></ul><p>效果如下:</p><p><img src="'+l+`" alt="version"></p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">current_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">5.0.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">当前的版本为【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">current_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 计算要升级的版本号</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 分割当前版本号为主版本、次版本和修订版本</span></span>
<span class="line"><span style="color:#A6ACCD;">IFS</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> read -ra version_parts </span><span style="color:#89DDFF;">&lt;&lt;&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">$current_version</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">major_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">version_parts</span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">]}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">minor_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">version_parts</span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">]}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">patch_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">version_parts</span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">]}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 计算下一个可能版本</span></span>
<span class="line"><span style="color:#A6ACCD;">next_major_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;$((</span><span style="color:#C3E88D;">major_version</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">))</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">minor_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">patch_version</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">next_minor_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">major_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">$((</span><span style="color:#C3E88D;">minor_version</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">))</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">patch_version</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">next_patch_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">major_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">minor_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">$((</span><span style="color:#C3E88D;">patch_version</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">))&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># echo &quot;\${next_major_version}-\${next_minor_version}-\${next_patch_version}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 让用户选择一个版本号</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 默认选择next_patch_version</span></span>
<span class="line"><span style="color:#A6ACCD;">selected_version</span><span style="color:#89DDFF;">=\${</span><span style="color:#A6ACCD;">next_patch_version</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 询问用户选择的函数</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ask_version()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">请选择一个版本:</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">select</span><span style="color:#A6ACCD;"> version </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">major(</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">next_major_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">&quot; &quot;</span><span style="color:#C3E88D;">minor(</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">next_minor_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">&quot; &quot;</span><span style="color:#C3E88D;">patch(</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">next_patch_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">&quot; &quot;</span><span style="color:#C3E88D;">自定义版本</span><span style="color:#89DDFF;">&quot; &quot;</span><span style="color:#C3E88D;">退出</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">case</span><span style="color:#A6ACCD;"> $version </span><span style="color:#89DDFF;font-style:italic;">in</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">major(</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">next_major_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        selected_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">next_major_version</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">minor(</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">next_minor_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        selected_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">next_minor_version</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">patch(</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">next_patch_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        selected_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">next_patch_version</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">自定义版本</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">read</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">请输入自定义版本: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">custom_version</span></span>
<span class="line"><span style="color:#A6ACCD;">        selected_version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#C3E88D;">custom_version</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">退出</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">exit</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">*)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">无效的选项，请重新选择.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">;;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">esac</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 调用函数询问用户选择</span></span>
<span class="line"><span style="color:#FFCB6B;">ask_version</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">升级后的版本号为【</span><span style="color:#89DDFF;">\${</span><span style="color:#C3E88D;">selected_version</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">】</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p><strong><code>shell</code>语句备注</strong></p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">IFS</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> read -ra version_parts </span><span style="color:#89DDFF;">&lt;&lt;&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">$current_version</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><ul><li><p>首先，将<code>IFS</code>设置为<code>.</code>，这意味着<code>Shell</code>将使用<code>.</code>作为<code>字段分隔符</code>，用于<code>将字符串分割成多个部分</code>;</p></li><li><p>然后，使用<code>read</code>命令结合<code>&lt;&lt;&lt;</code>操作符，将字符串<code>&quot;$current_version&quot;</code>作为<code>输入传递给read命令</code>;</p></li><li><p><code>read</code>命令读取输入，并将其<code>分割为多个字段</code>，并<code>将每个字段存储在一个数组中</code></p><ul><li><p><code>-a</code>选项告诉<code>read</code>命令<code>将字段存储在数组</code>中</p></li><li><p><code>-r</code>选项告诉它<code>不要对反斜杠进行转义</code></p></li></ul></li></ul>`,8),t=[e];function c(r,D,y,F,i,C){return a(),n("div",null,t)}const d=s(p,[["render",c]]);export{_ as __pageData,d as default};
