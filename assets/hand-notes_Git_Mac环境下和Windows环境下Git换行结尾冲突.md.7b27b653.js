import{_ as s,c as e,o,e as a}from"./app.fa87702c.js";const h=JSON.parse('{"title":"Mac环境下和Windows环境下Git换行结尾冲突","description":"","frontmatter":{"layout":"doc"},"headers":[{"level":2,"title":"原因","slug":"原因","link":"#原因","children":[]},{"level":2,"title":"Git配置项","slug":"git配置项","link":"#git配置项","children":[{"level":3,"title":"eol","slug":"eol","link":"#eol","children":[]},{"level":3,"title":"autocrlf","slug":"autocrlf","link":"#autocrlf","children":[]},{"level":3,"title":"safecrlf","slug":"safecrlf","link":"#safecrlf","children":[]}]},{"level":2,"title":"解决方法","slug":"解决方法","link":"#解决方法","children":[]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"relativePath":"hand-notes/Git/Mac环境下和Windows环境下Git换行结尾冲突.md"}'),l={name:"hand-notes/Git/Mac环境下和Windows环境下Git换行结尾冲突.md"},n=a(`<h1 id="mac环境下和windows环境下git换行结尾冲突" tabindex="-1">Mac环境下和Windows环境下Git换行结尾冲突 <a class="header-anchor" href="#mac环境下和windows环境下git换行结尾冲突" aria-hidden="true">#</a></h1><blockquote><p>今天遇到一个问题(我的电脑是<code>Mac</code>)</p></blockquote><blockquote><p>基于某个项目的<code>main</code>分支开发功能，开发完毕后，合并到基于<code>main</code>分支创建的测试分支上，结果发现了上百处冲突，顿时惊呆了</p></blockquote><blockquote><p>比如下面这样的冲突：</p></blockquote><p><img src="https://raw.githubusercontent.com/mx52jing/image-hosting/main/images/Git/WechatIMG456.jpg" alt="WechatIMG456"></p><blockquote><p>看起来内容都没改变，但是就是有冲突</p></blockquote><h2 id="原因" tabindex="-1">原因 <a class="header-anchor" href="#原因" aria-hidden="true">#</a></h2><blockquote><p>造成上面的冲突的原因是：文本文件所使用的<code>换行符</code>，在<code>不同的系统平台</code>上是不一样的</p></blockquote><blockquote><p><code>UNIX/Linux</code>使用的是<code>0x0A(LF)</code>，早期的<code>Mac OS</code>使用的是<code>0x0D(CR)</code>，后来的<code>OS X</code>在更换内核后与<code>UNIX</code>保持一致了</p></blockquote><blockquote><p><code>DOS/Windows</code>一直使用<code>0x0D0A(CRLF)</code>作为换行符</p></blockquote><blockquote><p>在不同平台上，换行符发生改变时，<code>Git</code>会认为整个文件被修改，这就造成我们没法<code>diff</code>，不能正确反映本次的修改</p></blockquote><h2 id="git配置项" tabindex="-1">Git配置项 <a class="header-anchor" href="#git配置项" aria-hidden="true">#</a></h2><h3 id="eol" tabindex="-1"><code>eol</code> <a class="header-anchor" href="#eol" aria-hidden="true">#</a></h3><ul><li>设置工作目录中文件的换行符，有三个值<code>LF</code>, <code>CRLF</code>和<code>native(默认，跟随操作系统)</code></li></ul><blockquote><p><code>Git</code>还提供了一些配置选项，用于在<code>提交</code>和<code>检出</code>时<code>自动转换换行符</code></p></blockquote><h3 id="autocrlf" tabindex="-1"><code>autocrlf</code> <a class="header-anchor" href="#autocrlf" aria-hidden="true">#</a></h3><blockquote><p>该配置可设置为下面几个值：</p></blockquote><ul><li><p><code>true</code>: 表示<code>提交</code>时转换为<code>LF</code>，<code>检出</code>时转换为<code>CRLF</code>,</p></li><li><p><code>false</code>: 表示<code>提交检出均不转换</code></p></li><li><p><code>input</code>: 表示<code>提交时</code>转换为<code>LF</code>，<code>检出时不转换</code></p></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 提交时转换为LF，检出时转换为CRLF</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.autocrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 设置提交检出均不自动转换换行符</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.autocrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 提交时转换为LF，检出时不转换</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.autocrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">input</span></span>
<span class="line"></span></code></pre></div><h3 id="safecrlf" tabindex="-1"><code>safecrlf</code> <a class="header-anchor" href="#safecrlf" aria-hidden="true">#</a></h3><blockquote><p>该配置可设置为下面几个值：</p></blockquote><ul><li><p><code>true</code>: 表示<code>不允许提交时包含不同换行符</code></p></li><li><p><code>warn</code>: 表示只在<code>有不同换行符</code>时警告</p></li><li><p><code>false</code>: 表示<code>允许提交时有不同换行符存在</code></p></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 校验混用则拒绝提交</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.safecrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 允许提交包含混合换行符的文件</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.safecrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 提交包含混合换行符的文件时给出警告</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.safecrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">warn</span></span>
<span class="line"></span></code></pre></div><h2 id="解决方法" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法" aria-hidden="true">#</a></h2><blockquote><p>我的解决方法如下，先配置<code>Git</code>转换和提交的规则</p></blockquote><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 提交时转换为LF，检出时不转换</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.autocrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">input</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 校验混用则拒绝提交</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.safecrlf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"></span></code></pre></div><blockquote><p>配置完成后，可查看是否配置成功</p></blockquote><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--global</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--list</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 如果有下面两项证明配置成功了</span></span>
<span class="line"><span style="color:#FFCB6B;">core.autocrlf=input</span></span>
<span class="line"><span style="color:#FFCB6B;">core.safecrlf=</span><span style="color:#82AAFF;">true</span></span>
<span class="line"></span></code></pre></div><blockquote><p>上面配置好后还没完，因为我是<code>Mac</code>，此时我的分支中(<code>feature/dev</code>)的文件中换行符都是<code>CRLF</code>，而目标分支(<code>feature/test</code>)的文件中都是<code>LF</code></p></blockquote><blockquote><p>我如果直接切到<code>feature/test</code>分支<code>merge</code>我的<code>feature/dev</code>还是会有大量冲突</p></blockquote><blockquote><p>因为我<code>本地的文件在设置前已经以不一致的换行符格式存在</code>，为了解决这个问题并让后续的合并顺畅，我需要<code>重新规范化我的文件并提交一次</code>。这是一个一次性的操作，确保所有文件的换行符格式一致。</p></blockquote><blockquote><p>重新规范化现有文件可执行如下命令(记得先加上上面的<code>Git</code>配置)：</p></blockquote><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--renormalize</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"></span></code></pre></div><blockquote><p>这个命令会重新扫描所有的文件，并根据当前的<code>Git</code>配置(包括<code>core.autocrlf</code>和<code>.gitattributes(可选，另一种方法，我没配置这个文件)</code>)规范化它们的换行符。</p></blockquote><blockquote><p>然后我将上面的修改提交后重新<code>merge</code>，现在的冲突都是代码层面的冲突，没有格式冲突了，然后就可以正常的修改的代码了</p></blockquote><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-hidden="true">#</a></h2><ul><li><p><a href="https://kuanghy.github.io/2017/03/19/git-lf-or-crlf" target="_blank" rel="noreferrer">Git 多平台换行符问题(LF or CRLF)</a></p></li><li><p><a href="https://blog.asroads.com/post/e037b783.html" target="_blank" rel="noreferrer">Windows环境和Mac环境下Git换行结尾冲突</a></p></li></ul>`,37),c=[n];function p(t,r,i,d,C,y){return o(),e("div",null,c)}const D=s(l,[["render",p]]);export{h as __pageData,D as default};
